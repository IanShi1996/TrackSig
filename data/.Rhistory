install.packages(R.matlab)
install.packages('R.matlab')
library(R.marlab)
library(R.matlab)
?load.image
load()
load("/Users/yulia/Documents/Methylation project/round2/.RData")
load("/Users/yulia/Documents/Methylation project/round2/RData2")
load("/Users/yulia/Documents/Methylation project/round2/.RData2")
load("/Users/yulia/Documents/Methylation project/round2/.RData3")
?merge
?join
?union
a <- c(10, 9, 8 , 7, 6, 5)
row_order <- c(10, 9 , 8, 7, 6, 5, 4, 3, 2, 1)
a[row_order]
wilcox.test(1, 1:10)
p_value_from_distribution <- function(value, distribution)
{
m <- mean(distribution)
if (value >= m)
{
p_value = sum(distribution > value)/length(distribution)
} else
{
p_value = sum(distribution < value)/length(distribution)
}
return(p_value)
}
p_value_from_distribution(1, 1:10)
p_value_from_distribution(1.5, 1:10)
p_value_from_distribution(1.5, 1:100)
p_value_from_distribution(1, 1:100)
p_value_from_distribution(10, 1:100)
p_value_from_distribution(9, 1:100)
p_value_from_distribution(99, 1:100)
p_value_from_distribution(100, 1:100)
?hclust
?dist
load("/Volumes/rweksberg/Yulia/RRBS data/in273_1.RData")
View(data)
dim(data)
head(data)
unique(bedGraphs$CpH)
unique(data$CpH)
load("/Users/yulia/Documents/imprinting_project/RRBS/Zymo_methylation/Zymo_methylation.RData")
head(RRBS)
load("/Users/yulia/Documents/imprinting_project/RRBS/Zymo_methylation/RRBS.RData")
mean(runif(1000, min=1, max=400))
mean(runif(1000, min=1, max=400))
mean(runif(1000, min=1, max=400))
mean(runif(1000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(100000, min=1, max=400))
mean(runif(10000000, min=1, max=400))
mean(runif(100000000, min=1, max=400))
mean(runif(1000000000, min=1, max=400))
?list.files
?split
?strsplit
?write.table
head(vaf_data)
vaf_values <- as.matrix(sapply(info, get_vaf), ncol=1)
?read.delim
setwd("Documents/mutational_signatures_release/data/")
tmp <= read.delim("vcf/test.vcf")
tmp <- read.delim("vcf/test.vcf")
head(tmp)
nrow(tmp)
sample(1:nrow(tmp), 5000)
s <- sample(1:nrow(tmp), 5000)
length(unique(s))
sort(s)
s <- sort(s)
tmp <- tmp[s,]
tmp
tmp <- tmp[s,tmp$FILTER == "."]
tmp <- tmp[,tmp$FILTER == "."]
tmp <- tmp[tmp$FILTER == ".",]
dim(tmp)
s <- sample(1:nrow(tmp), 3000)
s
s <- sort(s)
s <- sample(1:nrow(tmp), 1000)
s <- sort(s)
dim(tmp[s & tmp$FILTER == ".",])
tmp <- read.delim("vcf/test.vcf")
dim(tmp[s & tmp$FILTER == ".",])
length(S)
length(s)
dim(tmp[s & tmp$FILTER == ".",])
dim(tmp)
tmp <- tmp[s,]
dim(tmp[tmp$FILTER == ".",])
tmp <- read.delim("vcf/test.vcf")
s <- sample(1:nrow(tmp), 1500)
s <- sort(s)
tmp <- tmp[s,]
dim(tmp[tmp$FILTER == ".",])
write.delim(tmp, file="vcf/test_formatted.vcf", quote=F, row.names=F)
write(tmp, file="vcf/test_formatted.vcf", quote=F, row.names=F)
write.table(tmp, file="vcf/test_formatted.vcf", quote=F, row.names=F)
tmp$INFO <- " "
head(tmp)
write.table(tmp, file="vcf/test_formatted.vcf", quote=F, row.names=F)
read.delim("phi//test.txt")
phi <- read.delim("phi//test.txt")
length(S)
length(s)
phi <- runif(1500, min = 0, max = 1)
phi <- paste(paste(tmp$X.CHROM, tmp$POS, sep="_"), phi, sep="=")
head(phi)
phi <- runif(1500, min = 0, max = 1)
phi <- paste(paste(tmp$X.CHROM, tmp$POS, sep="_"), round(phi,digits = 3), sep="=")
head(phi)
data.frame(phi)
write.table(data.frame(phi), quote = F, row.names=F, file="phi//test_formatted.txt")
vcf <- tmp
phi <- runif(1500, min = 0, max = 1)
vcf$INFO <- paste0("SomeInfo;VAF=", phi)
head(vcf)
vcf$INFO <- paste0("SomeInfo;VAF=", round(phi,digits=3))
head(vcf)
write.table(data.frame(phi), quote = F, row.names=F, file="phi//test_formatted.txt")
phi <- paste(paste(tmp$X.CHROM, tmp$POS, sep="_"), round(phi,digits = 3), sep="=")
write.table(data.frame(phi), quote = F, row.names=F, file="phi//test_formatted.txt")
write.table(tmp, file="vcf/test_formatted.vcf", quote=F, row.names=F)
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F)
colnames(vcf)
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T)
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T,sep = "\t")
phi <- runif(1500, min = 0, max = 0.5)
vcf$INFO <- paste0("SomeInfo;VAF=", round(phi,digits=3))
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T,sep = "\t")
vcf.saved <- vcf
vcf$INFO <- ""
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T,sep = "\t")
vcf$INF
vcf$INFO
vcf$INFO <- " "
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T,sep = "\t")
vcf <- vcf.saved
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T,sep = "\t")
vcf$INFO <- " "
write.table(vcf, file="vcf/test_formatted.vcf", quote=F, row.names=F, col.names = T,sep = "\t")
